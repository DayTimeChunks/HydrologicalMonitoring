# Concnetrations to plot as box plot
keepDDtest <- c(
"Date.ti",
"diss.d13C.x", # "DD13C.diss",
"comp.d13C.North", "comp.d13C.Talweg", "comp.d13C.South" #,
#"DD13C.North", "DD13C.Talweg", "DD13C.South"
)
ws <- WaterSoils[, colnames(WaterSoils) %in% keepDDtest]
ws <- melt(ws, id="Date.ti")
ws$Source <- ifelse(ws$variable == "diss.d13C.x" , "Outlet",
ifelse(ws$variable == "comp.d13C.South", "South",
ifelse(ws$variable == "comp.d13C.Talweg", "Valley",
ifelse(ws$variable == "comp.d13C.North", "North", NA
))))
ws$Season = ifelse(ws$Date.ti > as.POSIXct('2016-05-25 00:06:00', tz = 'EST'), "Late", "Early")
ws$Group4 <- ifelse(ws$variable == "diss.d13C.x" & # Outlet
ws$Date.ti > as.POSIXct('2016-05-25 00:06:00', tz = 'EST'), "Outlet(Late)",
ifelse(ws$variable == "diss.d13C.x" &
ws$Date.ti <= as.POSIXct('2016-05-25 00:06:00', tz = 'EST'), "Outlet(Early)",
# South
ifelse(ws$variable == "comp.d13C.South" &
ws$Date.ti < as.POSIXct('2016-05-25 00:06:00', tz = 'EST'), "South(Early)",
ifelse(ws$variable == "comp.d13C.South" &
ws$Date.ti > as.POSIXct('2016-05-25 00:06:00', tz = 'EST'), "South(Late)",
# Valley
ifelse(ws$variable == "comp.d13C.Talweg" &
ws$Date.ti < as.POSIXct('2016-05-25 00:06:00', tz = 'EST'), "Valley(Early)",
ifelse(ws$variable == "comp.d13C.Talweg" &
ws$Date.ti > as.POSIXct('2016-05-25 00:06:00', tz = 'EST'), "Valley(Late)",
# North
ifelse(ws$variable == "comp.d13C.North" &
ws$Date.ti < as.POSIXct('2016-05-25 00:06:00', tz = 'EST'), "North(Early)",
ifelse(ws$variable == "comp.d13C.North" &
ws$Date.ti > as.POSIXct('2016-05-25 00:06:00', tz = 'EST'), "North(Late)", NA
))))))))
ws$Source = factor(ws$Source, levels = c( "Outlet",  "Valley", "North", "South"))
levels(ws$Source)
ws$Source = as.factor(ws$Source)
sources <- ggplot(ws, aes(Source, value)) +
geom_boxplot(aes(colour=Season)) +
theme_minimal() +
theme(text = element_text(size=17))+
# guides(col = guide_legend(nrow = 2)) +
#theme(axis.text.x=element_text(angle = 45, hjust = 1) ,
#axis.text.x=element_blank(),
#axis.title.x=element_blank(),
# legend.position="bottom"
#      )+
ylab(expression(paste({delta}^"13","C", ' (\u2030)')))
sources
plot_grid(
hy_noLeg,
out_noLeg,
sources,
ncol = 1,
align = 'hv')
sources_noLge = sources + theme(legend.position = 'none')
sources_noLeg = sources + theme(legend.position = 'none')
plot_grid(
hy_noLeg,
out_noLeg,
sources_noLeg,
ncol = 1,
align = 'hv')
out_noLeg +  theme(legend.position = "right",
# axis.text.x=element_text(angle = 45, hjust = 1),
# axis.text.x=element_blank(),
axis.title.x=element_blank()
)
ggplot(data = ch,
aes(x = Date, y = Conc.mug.L)) +
geom_point(aes(group = Event, colour = Season)) +
theme_minimal() +
ylab(expression(atop("Conc. S-Meto. ", paste({({mu}*g / L)} )))) +
scale_y_continuous( breaks = c(28, 24, 20, 16, 12, 8, 4, 0), limits = c(0, 28) ) +
# Smooth linear models
geom_smooth(data=subset(ch[2203:43539, ]), method = "lm", formula = y ~ poly(x, 2), se = F) +
geom_smooth(data=subset(ch[43539:nrow(ch)-1000, ]), method = "lm", formula = y ~ poly(x, 2), se= F) +
scale_x_datetime(limits = lims, breaks = date_breaks("2 weeks"), labels = date_format("%b %d")) +
guides(col = guide_legend(nrow = 2, title.position = "top"))
out = out_dates +
theme(# axis.text.x=element_text(angle = 45, hjust = 1) ,
axis.text.x=element_blank(),
axis.title.x=element_blank(),
legend.position="right"
)
out_dates = ggplot(data = ch,
aes(x = Date, y = Conc.mug.L)) +
geom_point(aes(group = Event, colour = Season)) +
theme_minimal() +
ylab(expression(atop("Conc. S-Meto. ", paste({({mu}*g / L)} )))) +
scale_y_continuous( breaks = c(28, 24, 20, 16, 12, 8, 4, 0), limits = c(0, 28) ) +
# Smooth linear models
geom_smooth(data=subset(ch[2203:43539, ]), method = "lm", formula = y ~ poly(x, 2), se = F) +
geom_smooth(data=subset(ch[43539:nrow(ch)-1000, ]), method = "lm", formula = y ~ poly(x, 2), se= F) +
scale_x_datetime(limits = lims, breaks = date_breaks("2 weeks"), labels = date_format("%b %d")) +
guides(col = guide_legend(nrow = 2, title.position = "top"))
out = out_dates +
theme(# axis.text.x=element_text(angle = 45, hjust = 1) ,
axis.text.x=element_blank(),
axis.title.x=element_blank(),
legend.position="right"
)
out
out_dates
out_dates_noLeg = out_dates  + theme(legend.position = 'none')
out_dates_noLeg = out_dates  + theme(legend.position = 'none')
sources_noLeg = sources + theme(legend.position = 'none')
grid2 = plot_grid(
hy_noLeg,
out_dates_noLeg,
sources_noLeg,
ncol = 1,
align = 'hv')
grid2
sources <- ggplot(ws, aes(Source, value)) +
geom_boxplot(aes(colour=Season)) +
theme_minimal() +
# guides(col = guide_legend(nrow = 2)) +
#theme(axis.text.x=element_text(angle = 45, hjust = 1) ,
#axis.text.x=element_blank(),
#axis.title.x=element_blank(),
# legend.position="bottom"
#      )+
ylab(expression(paste({delta}^"13","C", ' (\u2030)')))
sources
sources_noLeg = sources + theme(legend.position = 'none')
grid2 = plot_grid(
hy_noLeg,
out_dates_noLeg,
sources_noLeg,
ncol = 1,
align = 'hv')
grid2
grid2 = plot_grid(
hy_noLeg,
out_dates_noLeg,
sources_noLeg,
ncol = 1,
align = 'v')
grid2
ml2 = ggdraw() +
draw_plot(grid2, x=0.02, y = 0.0, width = 0.95, height = .95) +
draw_plot(out_leg, x=(0.53 ), y = 0.44, width = .8, height = 0.1) +
draw_plot(co_leg, x=(0.53) , y = 0.11, width = .8, height = 0.1) +
draw_label("A", x= 0.94, y = .93, size = 12, fontface = "bold") +
draw_label("B", x= 0.94, y = .62, size = 12, fontface = "bold") +
draw_label("C", x= 0.94, y = .31, size = 12, fontface = "bold")
ml2
so_leg = get_legend(sources)
so_leg
grid2 = plot_grid(
hy_noLeg,
out_dates_noLeg,
sources_noLeg,
ncol = 1,
align = 'v')
ml2 = ggdraw() +
draw_plot(grid2, x=0.02, y = 0.0, width = 0.95, height = .95) +
draw_plot(out_leg, x=(0.53 ), y = 0.44, width = .8, height = 0.1) +
draw_plot(so_leg, x=(0.53) , y = 0.11, width = .8, height = 0.1) +
draw_label("A", x= 0.94, y = .93, size = 12, fontface = "bold") +
draw_label("B", x= 0.94, y = .62, size = 12, fontface = "bold") +
draw_label("C", x= 0.94, y = .31, size = 12, fontface = "bold")
ml2
grid3 = plot_grid(
hy_noLeg,
out_noLeg,
co_noLeg,
sources_noLeg,
ncol = 1,
align = 'v')
grid3
grid3 = plot_grid(
hy_noLeg,
out_noLeg,
sources_noLeg,
co_noLeg,
ncol = 1,
align = 'v')
grid3
grid3 = plot_grid(
hy_noLeg,
out_noLeg,
co_noLeg,
sources_noLeg,
ncol = 1,
align = 'v')
grid3
ml3 = ggdraw() +
draw_plot(grid3, x=0.02, y = 0.0, width = 0.95, height = .95) +
draw_plot(out_leg, x=(0.53 ), y = 0.44, width = .8, height = 0.1) +
draw_plot(co_leg, x=(0.53 ), y = 0.22, width = .8, height = 0.1) +
draw_plot(so_leg, x=(0.53) , y = 0.11, width = .8, height = 0.1) +
draw_label("A", x= 0.94, y = .93, size = 12, fontface = "bold") +
draw_label("B", x= 0.94, y = .62, size = 12, fontface = "bold") +
draw_label("C", x= 0.94, y = .31, size = 12, fontface = "bold") +
draw_label("D", x= 0.94, y = .20, size = 12, fontface = "bold")
ml3
ml3 = ggdraw() +
draw_plot(grid3, x=0.02, y = 0.0, width = 0.95, height = .95) +
draw_plot(out_leg, x=(0.53 ), y = 0.75, width = .8, height = 0.1) +
draw_plot(co_leg, x=(0.53 ), y = 0.40, width = .8, height = 0.1) +
draw_plot(so_leg, x=(0.53) , y = 0.11, width = .8, height = 0.1) +
draw_label("A", x= 0.94, y = .93, size = 12, fontface = "bold") +
draw_label("B", x= 0.94, y = .80, size = 12, fontface = "bold") +
draw_label("C", x= 0.94, y = .45, size = 12, fontface = "bold") +
draw_label("D", x= 0.94, y = .20, size = 12, fontface = "bold")
ml3
ml3 = ggdraw() +
draw_plot(grid3, x=0.02, y = 0.0, width = 0.95, height = .95) +
draw_plot(out_leg, x=(0.53 ), y = 0.65, width = .8, height = 0.1) +
draw_plot(co_leg, x=(0.53 ), y = 0.35, width = .8, height = 0.1) +
draw_plot(so_leg, x=(0.53) , y = 0.8, width = .8, height = 0.1) +
draw_label("A", x= 0.94, y = .93, size = 12, fontface = "bold") +
draw_label("B", x= 0.94, y = .75, size = 12, fontface = "bold") +
draw_label("C", x= 0.94, y = .48, size = 12, fontface = "bold") +
draw_label("D", x= 0.94, y = .30, size = 12, fontface = "bold")
ml3
ml3 = ggdraw() +
draw_plot(grid3, x=0.02, y = 0.0, width = 0.95, height = .95) +
draw_plot(out_leg, x=(0.53 ), y = 0.65, width = .8, height = 0.1) +
draw_plot(co_leg, x=(0.53 ), y = 0.30, width = .8, height = 0.1) +
draw_plot(so_leg, x=(0.53) , y = 0.08, width = .8, height = 0.1) +
draw_label("A", x= 0.94, y = .93, size = 12, fontface = "bold") +
draw_label("B", x= 0.94, y = .75, size = 12, fontface = "bold") +
draw_label("C", x= 0.94, y = .48, size = 12, fontface = "bold") +
draw_label("D", x= 0.94, y = .25, size = 12, fontface = "bold")
ml3
ml3 = ggdraw() +
draw_plot(grid3, x=0.02, y = 0.0, width = 0.95, height = .95) +
draw_plot(out_leg, x=(0.53 ), y = 0.62, width = .8, height = 0.1) +
draw_plot(co_leg, x=(0.53 ), y = 0.30, width = .8, height = 0.1) +
draw_plot(so_leg, x=(0.53) , y = 0.08, width = .8, height = 0.1) +
draw_label("A", x= 0.94, y = .93, size = 12, fontface = "bold") +
draw_label("B", x= 0.94, y = .72, size = 12, fontface = "bold") +
draw_label("C", x= 0.94, y = .48, size = 12, fontface = "bold") +
draw_label("D", x= 0.94, y = .23, size = 12, fontface = "bold")
ml3
ml3 = ggdraw() +
draw_plot(grid3, x=0.02, y = 0.0, width = 0.95, height = .95) +
draw_plot(out_leg, x=(0.53 ), y = 0.59, width = .8, height = 0.1) +
draw_plot(co_leg, x=(0.53 ), y = 0.30, width = .8, height = 0.1) +
draw_plot(so_leg, x=(0.53) , y = 0.08, width = .8, height = 0.1) +
draw_label("A", x= 0.94, y = .93, size = 12, fontface = "bold") +
draw_label("B", x= 0.94, y = .72, size = 12, fontface = "bold") +
draw_label("C", x= 0.94, y = .48, size = 12, fontface = "bold") +
draw_label("D", x= 0.94, y = .23, size = 12, fontface = "bold")
ml3
ml3 = ggdraw() +
draw_plot(grid3, x=0.02, y = 0.0, width = 0.95, height = .95) +
draw_plot(out_leg, x=(0.53 ), y = 0.56, width = .8, height = 0.1) +
draw_plot(co_leg, x=(0.53 ), y = 0.30, width = .8, height = 0.1) +
draw_plot(so_leg, x=(0.53) , y = 0.08, width = .8, height = 0.1) +
draw_label("A", x= 0.94, y = .93, size = 12, fontface = "bold") +
draw_label("B", x= 0.94, y = .72, size = 12, fontface = "bold") +
draw_label("C", x= 0.94, y = .48, size = 12, fontface = "bold") +
draw_label("D", x= 0.94, y = .23, size = 12, fontface = "bold")
ml3
ml3 = ggdraw() +
draw_plot(grid3, x=0.02, y = 0.0, width = 0.95, height = .95) +
draw_plot(out_leg, x=(0.53 ), y = 0.56, width = .8, height = 0.1) +
draw_plot(co_leg, x=(0.53 ), y = 0.32, width = .8, height = 0.1) +
draw_plot(so_leg, x=(0.53) , y = 0.08, width = .8, height = 0.1) +
draw_label("A", x= 0.94, y = .93, size = 12, fontface = "bold") +
draw_label("B", x= 0.94, y = .72, size = 12, fontface = "bold") +
draw_label("C", x= 0.94, y = .50, size = 12, fontface = "bold") +
draw_label("D", x= 0.94, y = .23, size = 12, fontface = "bold")
ml3
ml3 = ggdraw() +
draw_plot(grid3, x=0.02, y = 0.0, width = 0.95, height = .95) +
draw_plot(out_leg, x=(0.54 ), y = 0.56, width = .8, height = 0.1) +
draw_plot(co_leg, x=(0.54 ), y = 0.32, width = .8, height = 0.1) +
draw_plot(so_leg, x=(0.54) , y = 0.08, width = .8, height = 0.1) +
draw_label("A", x= 0.94, y = .93, size = 12, fontface = "bold") +
draw_label("B", x= 0.94, y = .72, size = 12, fontface = "bold") +
draw_label("C", x= 0.94, y = .50, size = 12, fontface = "bold") +
draw_label("D", x= 0.94, y = .23, size = 12, fontface = "bold")
ml3
SAVE = T
PC = F
if (SAVE){
if (PC){
ggsave(ml3,
filename = "D:/Documents/these_pablo/WriteUp/WaterResearch/images/multilevel4.pdf",
device = "pdf", dpi = 600,  scale = 1, # )# ,
width = 7, height = 11)
} else {
ggsave(ml3,
filename = "/Users/DayTightChunks/Documents/PhD/Writeups/Journals/WaterResearch/images/multilevel4.pdf",
device="pdf", dpi = 600,  scale = 1, # )# ,
width = 7, height = 11)
}
}
SAVE = T
PC = F
if (SAVE){
if (PC){
ggsave(sources,
filename = "D:/Documents/these_pablo/WriteUp/WaterResearch/images/boxplot.pdf",
device = "pdf", dpi = 600,  scale = 1, # )# ,
width = 8.7, height = 4)
} else {
ggsave(sources,
filename = "/Users/DayTightChunks/Documents/PhD/Writeups/WaterResearch/images/boxplot.pdf",
device="pdf", dpi = 600,  scale = 1, # )# ,
width = 8.7, height = 4)
}
}
if (SAVE){
if (PC){
ggsave(sources,
filename = "D:/Documents/these_pablo/WriteUp/WaterResearch/images/boxplot.pdf",
device = "pdf", dpi = 600,  scale = 1, # )# ,
width = 8.7, height = 4)
} else {
ggsave(sources,
filename = "/Users/DayTightChunks/Documents/PhD/Writeups/Journals/WaterResearch/images/boxplot.pdf",
device="pdf", dpi = 600,  scale = 1, # )# ,
width = 8.7, height = 4)
}
}
SAVE = T
PC = F
if (SAVE){
if (PC){
ggsave(sources,
filename = "D:/Documents/these_pablo/WriteUp/WaterResearch/images/boxplot.pdf",
device = "pdf", dpi = 600,  scale = 1, # )# ,
width = 8.7, height = 4)
} else {
ggsave(sources,
filename = "/Users/DayTightChunks/Documents/PhD/Writeups/Journals/WaterResearch/images/boxplot.pdf",
device=cairo_pdf, dpi = 600,  scale = 1, # )# ,
width = 8.7, height = 4)
}
}
SAVE = T
PC = F
if (SAVE){
if (PC){
ggsave(ml3,
filename = "D:/Documents/these_pablo/WriteUp/WaterResearch/images/multilevel4.pdf",
device = "pdf", dpi = 600,  scale = 1, # )# ,
width = 7, height = 11)
} else {
ggsave(ml3,
filename = "/Users/DayTightChunks/Documents/PhD/Writeups/Journals/WaterResearch/images/multilevel4.pdf",
device=cairo_pdf, dpi = 600,  scale = 1, # )# ,
width = 7, height = 11)
}
}
SAVE = T
PC = F
if (SAVE){
if (PC){
ggsave(ml3,
filename = "D:/Documents/these_pablo/WriteUp/WaterResearch/images/multilevel4.pdf",
device = "pdf", dpi = 600,  scale = 1, # )# ,
width = 7, height = 10)
} else {
ggsave(ml3,
filename = "/Users/DayTightChunks/Documents/PhD/Writeups/Journals/WaterResearch/images/multilevel4.pdf",
device=cairo_pdf, dpi = 600,  scale = 1, # )# ,
width = 7, height = 10)
}
}
ml3 = ggdraw() +
draw_plot(grid3, x=0.02, y = 0.0, width = 0.95, height = .95) +
draw_plot(out_leg, x=(0.54 ), y = 0.56, width = .8, height = 0.1) +
draw_plot(co_leg, x=(0.54 ), y = 0.32, width = .8, height = 0.1) +
draw_plot(so_leg, x=(0.54) , y = 0.08, width = .8, height = 0.1) +
draw_label("A", x= 0.94, y = .93, size = 12, fontface = "bold") +
draw_label("B", x= 0.94, y = .69, size = 12, fontface = "bold") +
draw_label("C", x= 0.94, y = .47, size = 12, fontface = "bold") +
draw_label("D", x= 0.94, y = .23, size = 12, fontface = "bold")
ml3
SAVE = T
PC = F
if (SAVE){
if (PC){
ggsave(ml3,
filename = "D:/Documents/these_pablo/WriteUp/WaterResearch/images/multilevel4.pdf",
device = "pdf", dpi = 600,  scale = 1, # )# ,
width = 7, height = 10)
} else {
ggsave(ml3,
filename = "/Users/DayTightChunks/Documents/PhD/Writeups/Journals/WaterResearch/images/multilevel4.pdf",
device=cairo_pdf, dpi = 600,  scale = 1, # )# ,
width = 7, height = 10)
}
}
View(ch)
out_dates = ggplot(data = ch,
aes(x = Date, y = Conc.mug.L)) +
geom_errorbar(aes(ymin = Conc.mug.L - Conc.SD, ymax = Conc.mug.L + Conc.SD)) +
geom_point(aes(group = Event, colour = Season)) +
theme_minimal() +
ylab(expression(atop("Conc. S-Meto. ", paste({({mu}*g / L)} )))) +
scale_y_continuous( breaks = c(28, 24, 20, 16, 12, 8, 4, 0), limits = c(0, 28) ) +
# Smooth linear models
geom_smooth(data=subset(ch[2203:43539, ]), method = "lm", formula = y ~ poly(x, 2), se = F) +
geom_smooth(data=subset(ch[43539:nrow(ch)-1000, ]), method = "lm", formula = y ~ poly(x, 2), se= F) +
scale_x_datetime(limits = lims, breaks = date_breaks("2 weeks"), labels = date_format("%b %d")) +
guides(col = guide_legend(nrow = 2, title.position = "top"))
out = out_dates +
theme(# axis.text.x=element_text(angle = 45, hjust = 1) ,
axis.text.x=element_blank(),
axis.title.x=element_blank(),
legend.position="right"
)
if (tags){
out + geom_text_repel(aes(label=Events), # WeekSubWeek or Weeks
size = 3,
arrow = arrow(length = unit(0.005, 'npc'), type = "closed"),
force = 0.5,
point.padding = unit(0.5, 'lines'),
max.iter = 2e3,
nudge_x = .05, show.legend = F)
}
out_dates
out_dates = ggplot(data = ch,
aes(x = Date, y = Conc.mug.L)) +
geom_errorbar(aes(ymin = Conc.mug.L - Conc.SD, ymax = Conc.mug.L + Conc.SD, colour = Season)) +
geom_point(aes(group = Event, colour = Season)) +
theme_minimal() +
ylab(expression(atop("Conc. S-Meto. ", paste({({mu}*g / L)} )))) +
scale_y_continuous( breaks = c(28, 24, 20, 16, 12, 8, 4, 0), limits = c(0, 28) )
out_dates = ggplot(data = ch,
aes(x = Date, y = Conc.mug.L)) +
geom_errorbar(aes(ymin = Conc.mug.L - Conc.SD, ymax = Conc.mug.L + Conc.SD, colour = Season)) +
geom_point(aes(group = Event, colour = Season)) +
theme_minimal() +
ylab(expression(atop("Conc. S-Meto. ", paste({({mu}*g / L)} )))) +
scale_y_continuous( breaks = c(28, 24, 20, 16, 12, 8, 4, 0), limits = c(0, 28) ) +
# Smooth linear models
geom_smooth(data=subset(ch[2203:43539, ]), method = "lm", formula = y ~ poly(x, 2), se = F) +
geom_smooth(data=subset(ch[43539:nrow(ch)-1000, ]), method = "lm", formula = y ~ poly(x, 2), se= F) +
scale_x_datetime(limits = lims, breaks = date_breaks("2 weeks"), labels = date_format("%b %d")) +
guides(col = guide_legend(nrow = 2, title.position = "top"))
out = out_dates +
theme(# axis.text.x=element_text(angle = 45, hjust = 1) ,
axis.text.x=element_blank(),
axis.title.x=element_blank(),
legend.position="right"
)
if (tags){
out + geom_text_repel(aes(label=Events), # WeekSubWeek or Weeks
size = 3,
arrow = arrow(length = unit(0.005, 'npc'), type = "closed"),
force = 0.5,
point.padding = unit(0.5, 'lines'),
max.iter = 2e3,
nudge_x = .05, show.legend = F)
}
out_dates
grid3 = plot_grid(
hy_noLeg,
out_noLeg,
co_noLeg,
sources_noLeg,
ncol = 1,
align = 'v')
ml3 = ggdraw() +
draw_plot(grid3, x=0.02, y = 0.0, width = 0.95, height = .95) +
draw_plot(out_leg, x=(0.54 ), y = 0.56, width = .8, height = 0.1) +
draw_plot(co_leg, x=(0.54 ), y = 0.32, width = .8, height = 0.1) +
draw_plot(so_leg, x=(0.54) , y = 0.08, width = .8, height = 0.1) +
draw_label("A", x= 0.94, y = .93, size = 12, fontface = "bold") +
draw_label("B", x= 0.94, y = .69, size = 12, fontface = "bold") +
draw_label("C", x= 0.94, y = .47, size = 12, fontface = "bold") +
draw_label("D", x= 0.94, y = .23, size = 12, fontface = "bold")
ml3
hy_noLeg <- hy + theme(legend.position = 'none')
out_noLeg = out +  theme(legend.position = 'none')
co_noLeg = co +  theme(legend.position = 'none')
out_leg <- get_legend(out)
co_leg <- get_legend(co)
grid3 = plot_grid(
hy_noLeg,
out_noLeg,
co_noLeg,
sources_noLeg,
ncol = 1,
align = 'v')
ml3 = ggdraw() +
draw_plot(grid3, x=0.02, y = 0.0, width = 0.95, height = .95) +
draw_plot(out_leg, x=(0.54 ), y = 0.56, width = .8, height = 0.1) +
draw_plot(co_leg, x=(0.54 ), y = 0.32, width = .8, height = 0.1) +
draw_plot(so_leg, x=(0.54) , y = 0.08, width = .8, height = 0.1) +
draw_label("A", x= 0.94, y = .93, size = 12, fontface = "bold") +
draw_label("B", x= 0.94, y = .69, size = 12, fontface = "bold") +
draw_label("C", x= 0.94, y = .47, size = 12, fontface = "bold") +
draw_label("D", x= 0.94, y = .23, size = 12, fontface = "bold")
ml3
out_noLeg
ml3
SAVE = T
PC = F
if (SAVE){
if (PC){
ggsave(ml3,
filename = "D:/Documents/these_pablo/WriteUp/WaterResearch/images/multilevel4.pdf",
device = "pdf", dpi = 600,  scale = 1, # )# ,
width = 7, height = 10)
} else {
ggsave(ml3,
filename = "/Users/DayTightChunks/Documents/PhD/Writeups/Journals/WaterResearch/images/multilevel4.pdf",
device=cairo_pdf, dpi = 600,  scale = 1, # )# ,
width = 7, height = 10)
}
}
